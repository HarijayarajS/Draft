Perfect â€” below is a production-ready template you can drop into your project to make all error responses common, clean, and reusable across all handlers.


---

âœ… 1. common_responses.rs (new file)

use utoipa::ToResponse;
use crate::models::RestCommonResponse;

/// 401 Unauthorized (Invalid token, expired, missing, mismatched org, etc.)
#[derive(ToResponse)]
#[response(
    description = "Access denied",
    example = json!({"success": false, "error": "Invalid or expired token"})
)]
pub struct UnauthorizedResponse(RestCommonResponse);

/// 500 Internal Server Error
#[derive(ToResponse)]
#[response(
    description = "Unexpected error",
    example = json!({"success": false, "error": "Unexpected server error"})
)]
pub struct InternalServerErrorResponse(RestCommonResponse);

âœ… Single location
âœ… Example included
âœ… Uses your shape (RestCommonResponse)


---

âœ… 2. Register them in OpenApi

#[derive(OpenApi)]
#[openapi(
    paths(
        // ...
    ),
    components(
        schemas(RestCommonResponse),
        responses(
            UnauthorizedResponse,
            InternalServerErrorResponse
        )
    )
)]
pub struct ApiDoc;


---

âœ… 3. Use them anywhere

#[utoipa::path(
    get,
    path = "/auth",
    summary = "Issue access & refresh tokens",
    responses(
        (status = 200, body = RestDataResponse<AuthTokenResponse>),
        (ref = "UnauthorizedResponse"),
        (ref = "InternalServerErrorResponse")
    ),
    security(
        ("AUTHORIZATION" = [])
    )
)]
pub async fn get_auth_token() {}

No duplication, consistent everywhere.


---

âœ… 4. (Optional) Helper macro for even less typing

Create:

macro_rules! common_errors {
    () => {
        (ref = "UnauthorizedResponse"),
        (ref = "InternalServerErrorResponse")
    };
}

pub(crate) use common_errors;

Then:

#[utoipa::path(
    get,
    path = "/category/grid",
    responses(
        (status = 200, body = RestDataResponse<CategoryGridResponse>),
        common_errors!()
    )
)]

Done âœ…


---

âœ… 5. Bonus improvement (recommended)

Add one more reusable response for:

403 Forbidden (permissions)

400 Bad Request (validation)


Example:

#[derive(ToResponse)]
#[response(
    description = "Invalid input",
    example = json!({"success": false, "error": "Missing required fields"})
)]
pub struct BadRequestResponse(RestCommonResponse);

Youâ€™ll use it a lot.


---

ðŸŽ¯ Result

This gives you:

Centralized error response documentation

Cleaner handlers

Auto-updated examples

No duplication across 50+ endpoints

Perfectly consistent Swagger UI



---

If you want, I can also generate:

âœ… 403 Forbidden
âœ… 404 Not Found
âœ… 408 Request Timeout
âœ… 429 Too Many Requests

Just tell me.