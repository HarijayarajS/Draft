/// Closes the WebSocket connection and aborts all background threads
#[tracing::instrument(skip(self), fields(org_id, client_id, venue_id))]
pub async fn close_connection(&self) {
    self.is_closed.store(true, Ordering::Relaxed);

    // Give threads time to observe shutdown flag
    tokio::time::sleep(Duration::from_millis(100)).await;

    let mut threads = self.threads.lock().await;

    for thread in threads.drain(..) {
        match tokio::time::timeout(Duration::from_secs(2), thread).await {
            Ok(Ok(())) => {
                tracing::debug!("BaseWSClient: thread shut down gracefully");
            }
            Ok(Err(e)) => {
                tracing::error!("BaseWSClient: thread panicked: {:?}", e);
            }
            Err(_) => {
                tracing::warn!("BaseWSClient: Force aborting thread");
                thread.abort();
            }
        }
    }
}